@extends('master.front_end.app')

@section('content')
    <!-- New Arrival -->
    <section class="padding-top-100 padding-bottom-100">
        <div class="container">

            <!-- Main Heading -->
            <div class="heading text-center">
                <h4>new arrival</h4>
                <span>Be among the first to discover exciting new options in the world of cooking oils and culinary
                    essentials. Stay ahead of the culinary curve with our newest arrivals, carefully curated for your
                    culinary delight.</span>
            </div>
        </div>

        <!-- New Arrival -->
        <div class="arrival-block">

            <!-- Item -->
            <div class="item">
                <!-- Images -->
                <img class="img-1" src="images/arrival-1.png" alt=""> <img class="img-2" src="images/arrival-1.png"
                    alt="">
                <!-- Overlay  -->
                <div class="overlay">
                    <!-- Price -->
                    <span class="price"><small>Rp</small>23.500</span>
                    <div class="position-center-center"> <a href="images/arrival-1.png" data-lighter><i
                                class="icon-magnifier"></i></a> </div>
                </div>
                <!-- Item Name -->
                <div class="item-name"> <a href="#.">bimoli</a>
                    <p>Minyak goreng yang diperkaya Vit E dan Pro-Vit A, Omega-6 dan Omega-9</p>
                </div>
            </div>

            <!-- Item -->
            <div class="item">
                <!-- Images -->
                <img class="img-1" src="images/arrival-2.png" alt=""> <img class="img-2"
                    src="images/arrival-2.png" alt="">
                <!-- Overlay  -->
                <div class="overlay">
                    <!-- Price -->
                    <span class="price"><small>Rp</small>13.000</span>
                    <div class="position-center-center"> <a href="images/arrival-2.png" data-lighter><i
                                class="icon-magnifier"></i></a> </div>
                </div>
                <!-- Item Name -->
                <div class="item-name"> <a href="#.">minyakita</a>
                    <p>Minyak goreng yang berkualitas dengan dilengkapi Vit A dan Vit B, rendah kandungan lemak jenuh</p>
                </div>
            </div>

            <!-- Item -->
            <div class="item">
                <!-- Images -->
                <img class="img-1" src="images/arrival-3.png" alt=""> <img class="img-2"
                    src="images/arrival-3.png" alt="">
                <!-- Overlay  -->
                <div class="overlay">
                    <!-- Price -->
                    <span class="price"><small>Rp</small>16.100</span>
                    <div class="position-center-center"> <a href="images/arrival-3.png" data-lighter><i
                                class="icon-magnifier"></i></a> </div>
                </div>
                <!-- Item Name -->
                <div class="item-name"> <a href="#.">fortune</a>
                    <p>Minyak goreng yang mengandung Omega-3 dan Omega-9, serta Vit A dan Vit E</p>
                </div>
            </div>

            <!-- Item -->
            <div class="item">
                <!-- Images -->
                <img class="img-1" src="images/arrival-4.png" alt=""> <img class="img-2"
                    src="images/arrival-4.png" alt="">
                <!-- Overlay  -->
                <div class="overlay">
                    <!-- Price -->
                    <span class="price"><small>Rp</small>28.900</span>
                    <div class="position-center-center"> <a href="images/arrival-4.png" data-lighter><i
                                class="icon-magnifier"></i></a> </div>
                </div>
                <!-- Item Name -->
                <div class="item-name"> <a href="#.">barco</a>
                    <p>Minyak goreng yang terbuat dari kelapa sawit dan baik dikonsumsi untuk diet</p>
                </div>
            </div>

            <!-- Item -->
            <div class="item">
                <!-- Images -->
                <img class="img-1" src="images/arrival-5.png" alt=""> <img class="img-2"
                    src="images/arrival-5.png" alt="">
                <!-- Overlay  -->
                <div class="overlay">
                    <!-- Price -->
                    <span class="price"><small>Rp</small>16.450</span>
                    <div class="position-center-center"> <a href="images/arrival-5.png" data-lighter><i
                                class="icon-magnifier"></i></a> </div>
                </div>
                <!-- Item Name -->
                <div class="item-name"> <a href="#.">forvita</a>
                    <p>Minyak goreng yang mengandung Vit E serta kaya akan antioksidan</p>
                </div>
            </div>

            <!-- Item -->
            <div class="item">
                <!-- Images -->
                <img class="img-1" src="images/arrival-6.png" alt=""> <img class="img-2"
                    src="images/arrival-6.png" alt="">
                <!-- Overlay  -->
                <div class="overlay">
                    <!-- Price -->
                    <span class="price"><small>Rp</small>17.000</span>
                    <div class="position-center-center"> <a href="images/arrival-6.png" data-lighter><i
                                class="icon-magnifier"></i></a> </div>
                </div>
                <!-- Item Name -->
                <div class="item-name"> <a href="#.">rose brand</a>
                    <p>Minyak kelapa sawit dengan kandungan BETA karoten, Omega-9, Vit A dan E</p>
                </div>
            </div>

            <!-- Item -->
            <div class="item">
                <!-- Images -->
                <img class="img-1" src="images/arrival-7.png" alt=""> <img class="img-2"
                    src="images/arrival-7.png" alt="">
                <!-- Overlay  -->
                <div class="overlay">
                    <!-- Price -->
                    <span class="price"><small>Rp</small>17.000</span>
                    <div class="position-center-center"> <a href="images/arrival-7.png" data-lighter><i
                                class="icon-magnifier"></i></a> </div>
                </div>
                <!-- Item Name -->
                <div class="item-name"> <a href="#.">filma</a>
                    <p>Minyak yang mengandung asam lemak tak jenuh, Omega-3 dan 9, serta Vit D</p>
                </div>
            </div>

            <!-- Item -->
            <div class="item">
                <!-- Images -->
                <img class="img-1" src="images/arrival-8.png" alt=""> <img class="img-2"
                    src="images/arrival-8.png" alt="">
                <!-- Overlay  -->
                <div class="overlay">
                    <!-- Price -->
                    <span class="price"><small>Rp</small>18.500</span>
                    <div class="position-center-center"> <a href="images/arrival-8.png" data-lighter><i
                                class="icon-magnifier"></i></a> </div>
                </div>
                <!-- Item Name -->
                <div class="item-name"> <a href="#.">sania</a>
                    <p>Minyak goreng yang terbuat dari VCO dan kelapa sawit pilihan</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Popular Products -->
    <section class="padding-top-50 padding-bottom-150">
        <div class="container">

            <!-- Main Heading -->
            <div class="heading text-center">
                <h4>popular products</h4>
                <span>Explore our handpicked selection of popular products that our customers love. From premium cooking
                    oils to culinary essentials, these items have earned their place at the top of our list.</span>
            </div>

            <!-- Popular Item Slide -->
            <div class="papular-block block-slide">

                <!-- Item -->
                <div class="item">
                    <!-- Item img -->
                    <div class="item-img"> <img class="img-1" src="images/produk-1.png" alt=""> <img
                            class="img-2" src="images/produk-1.png" alt="">
                        <!-- Overlay -->
                        <div class="overlay">
                            <div class="position-center-center">
                                <div class="inn">
                                    <a href="images/product-1.jpg" data-lighter>
                                        <i class="icon-magnifier"></i>
                                    </a>
                                    <a class="product" data-product-id="1" data-toggle="tooltip" data-placement="top"
                                        title="Add To Cart" style="cursor: pointer;">
                                        <i class="icon-basket"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Item Name -->
                    <div class="item-name"> <a href="#."><span id="nameProduct1">sunco</span></a>
                        <p>Minyak yang kaya kandungan Vit E dan Pro-Vit A, serta antioksidan</p>
                    </div>
                    <!-- Price -->
                    <span class="price" data-price-id="1"><small>Rp</small>20.000</span>
                </div>

                <!-- Item -->
                <div class="item">
                    <!-- Item img -->
                    <div class="item-img"> <img class="img-1" src="images/produk-2.png" alt=""> <img
                            class="img-2" src="images/produk-2.png" alt="">
                        <!-- Overlay -->
                        <div class="overlay">
                            <div class="position-center-center">
                                <div class="inn">
                                    <a href="images/product-2.jpg" data-lighter><i class="icon-magnifier"></i>
                                    </a>
                                    <a class="product" data-product-id="2" data-toggle="tooltip" data-placement="top"
                                        title="Add To Cart" style="cursor: pointer;"><i class="icon-basket"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Item Name -->
                    <div class="item-name"> <a href="#."><span id="nameProduct2">tropical</span></a>
                        <p>Minyak yang rendah kolesterol karena mengandung Omega-9, Pro-Vit A, Vit E</p>
                    </div>
                    <!-- Price -->
                    <span class="price" data-price-id="2"><small>Rp</small>27.930</span>
                </div>

                <!-- Item -->
                <div class="item">
                    <!-- Item img -->
                    <div class="item-img"> <img class="img-1" src="images/produk-3.png" alt=""> <img
                            class="img-2" src="images/produk-3.png" alt="">
                        <!-- Overlay -->
                        <div class="overlay">
                            <div class="position-center-center">
                                <div class="inn">
                                    <a href="images/product-3.jpg" data-lighter><i class="icon-magnifier"></i>
                                    </a>
                                    <a class="product" data-product-id="3" data-toggle="tooltip" data-placement="top"
                                        title="Add To Cart" style="cursor: pointer;"><i class="icon-basket"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Item Name -->
                    <div class="item-name"> <a href="#."><span id="nameProduct3">tropicana slim</span></a>
                        <p>Minyak yang terbuat dari gula jagung dan rendah kalori</p>
                    </div>
                    <!-- Price -->
                    <span class="price" data-price-id="3"><small>Rp</small>80.000</span>
                </div>

                <!-- Item -->
                <div class="item">
                    <!-- Item img -->
                    <div class="item-img"> <img class="img-1" src="images/produk-4.png" alt=""> <img
                            class="img-2" src="images/produk-4.png" alt="">
                        <!-- Overlay -->
                        <div class="overlay">
                            <div class="position-center-center">
                                <div class="inn">
                                    <a href="images/product-4.jpg" data-lighter><i class="icon-magnifier"></i>
                                    </a>
                                    <a class="product" data-product-id="4" data-toggle="tooltip" data-placement="top"
                                        title="Add To Cart" style="cursor: pointer;"><i class="icon-basket"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Item Name -->
                    <div class="item-name"> <a href="#."><span id="nameProduct4">kunci mas</span></a>
                        <p>Minyak yang mengandung bebas lemak, antioksidan alami, Vit E, Omega-6 dan 9</p>
                    </div>
                    <!-- Price -->
                    <span class="price" data-price-id="4"><small>Rp</small>15.100</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonial -->
    <section class="testimonial padding-top-100">
        <div class="container">
            <div class="row">
                <div class="col-sm-6">

                    <!-- SLide -->
                    <div class="single-slide">

                        <!-- Slide -->
                        <div class="testi-in"> <i class="fa fa-quote-left"></i>
                            <p>Phasellus lacinia fermentum bibendum. Interdum et malesuada fames ac ante ipsum primis in
                                faucibus. Sed ullamcorper sapien lacus, eu posuere odio luctus non. Nulla lacinia, eros vel
                                fermentum consectetur, risus p</p>
                            <h5>john smith</h5>
                        </div>

                        <!-- Slide -->
                        <div class="testi-in"> <i class="fa fa-quote-left"></i>
                            <p>Phasellus lacinia fermentum bibendum. Interdum et malesuada fames ac ante ipsum primis in
                                faucibus. Sed ullamcorper sapien lacus, eu posuere odio luctus non. Nulla lacinia, eros vel
                                fermentum consectetur, risus p</p>
                            <h5>john smith</h5>
                        </div>

                        <!-- Slide -->
                        <div class="testi-in"> <i class="fa fa-quote-left"></i>
                            <p>Phasellus lacinia fermentum bibendum. Interdum et malesuada fames ac ante ipsum primis in
                                faucibus. Sed ullamcorper sapien lacus, eu posuere odio luctus non. Nulla lacinia, eros vel
                                fermentum consectetur, risus p</p>
                            <h5>john smith</h5>
                        </div>
                    </div>
                </div>

                <!-- Img -->
                <div class="col-sm-6"> <img class="img-responsive" src="images/review.jpg" alt=""> </div>
            </div>
        </div>
    </section>
@endsection

@section('js')
    <script>
        $(document).ready(function() {

            fetch_cart();

            $('.product').click(function() {
                var user = '{{ Auth::user() }}';
                if (user == '') {
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: 'You must login first!',
                    })
                    return false;
                }
                var productId = $(this).data('product-id');
                var nameProduct = $('#nameProduct' + productId).text();
                var priceProduct = $(this).closest('.item').find('.price[data-price-id="' + productId +
                    '"]').text();
                console.log(priceProduct);
                var imageProduct = 'images/produk-' + productId + '.png';
                $.ajax({
                    url: "{{ route('frontend.cart.add') }}",
                    method: "POST",
                    data: {
                        name_product: nameProduct,
                        price_product: priceProduct,
                        image_product: imageProduct,
                        _token: '{{ csrf_token() }}'
                    },
                    success: function(data) {
                        fetch_cart();

                        Swal.fire({
                            icon: 'success',
                            title: 'Success',
                            text: 'Add to cart success!',
                            timer: 1500
                        })
                    }
                });
            })

            $('.logout').on('click', function() {
                Swal.fire({
                    title: 'Are you sure?',
                    text: "You want to logout?",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#d33',
                    cancelButtonColor: '#3085d6',
                    confirmButtonText: 'Logout'
                }).then((result) => {
                    if (result.isConfirmed) {
                        $.ajax({
                            url: "{{ route('frontend.logout') }}",
                            method: "POST",
                            data: {
                                _token: "{{ csrf_token() }}"
                            },
                            success: function(response) {
                                Swal.fire(
                                    'Logout!',
                                    'You are logout.',
                                    'success'
                                ).then((result) => {
                                    if (result.isConfirmed) {
                                        window.location.href =
                                            "{{ route('frontend.index') }}";
                                    }
                                })
                            }
                        })
                    }
                })
            })
        })

        function fetch_cart() {
            $.ajax({
                url: "{{ route('frontend.cart.get') }}",
                method: "GET",
                success: function(data) {
                    $('.cart-items').empty();

                    var totalCart = 0;
                    // Iterasi melalui data dan buat elemen <li> untuk setiap produk
                    for (var i = 0; i < data.length; i++) {
                        var product = data[i];

                        // Buat elemen <li> dan isinya sesuai dengan data produk
                        var li = $('<li>');
                        var mediaLeft = $('<div class="media-left">');
                        var cartImg = $('<div class="cart-img">');
                        var img = $('<img class="media-object img-responsive" alt="...">');
                        img.attr('src', product.image_product);
                        cartImg.append(img);
                        mediaLeft.append(cartImg);

                        var mediaBody = $('<div class="media-body">');
                        var heading = $('<h6 class="media-heading">').text(product.name_product);

                        // Menghilangkan simbol mata uang dan mengonversi harga ke tipe data numerik
                        var priceText = product
                            .price_product; // Biarkan format harga seperti yang diterima dari data
                        var price = parseFloat(priceText.replace('Rp', '').replace('.', '').replace(',',
                            '.')); // Hilangkan simbol "Rp" dan ubah format angka
                        var priceFormatted = "Rp " + price.toLocaleString('id-ID', {
                            minimumFractionDigits: 0
                        }); // Format harga dengan pemisah ribuan
                        var priceSpan = $('<span class="price">').text(priceFormatted);

                        // Memastikan atribut "quantity" ada dalam data produk
                        var qty = product.hasOwnProperty('quantity') ? '<span class="qty">QTY: ' + product
                            .quantity + '</span>' : '';

                        mediaBody.append(heading);
                        mediaBody.append(priceSpan);
                        mediaBody.append(qty);

                        li.append(mediaLeft);
                        li.append(mediaBody);

                        // Tambahkan elemen <li> ke daftar belanja
                        $('.cart-items').append(li);

                        totalCart += price;
                    }
                    $('.total-cart').text(`Rp ` + totalCart.toLocaleString('id-ID', {
                        minimumFractionDigits: 0
                    }));
                }
            })
        }
    </script>
@endsection
